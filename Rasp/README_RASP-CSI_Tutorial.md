

## **CSI Data Acquisition Procedure**

To enable Channel State Information (CSI) data collection, it is first necessary to follow the setup instructions provided in the *Getting Started* section of the [**Nexmonster Repository**](https://github.com/nexmonster/nexmon_csi/tree/pi-5.10.92). The contributions of Matthias Schulz, Daniel Wegemer, Matthias Hollick, Francesco Gringoli, and Jakob Link are duly acknowledged for their work referenced herein.

Upon completing the preliminary configuration steps, CSI data acquisition can be performed as follows.

---

### Network Traffic Generation

For this experiment, the [**iPerf2 for Android**](https://play.google.com/store/apps/details?id=iperf.project&hl=en) application was employed to generate network traffic. The command executed was:

```bash
iperf -c 192.168.1.1 -u -b 500M -t 60 -i 1 -l 1400 -p 5500
```

Where:

* `-c` → Operates as client mode.
* `<IP>` → IP address of the Access Point (AP).
* `-u` → Specifies transmission via UDP protocol.
* `-b` → Defines the transmission bandwidth (in this case, 500 Mbps).
* `-t` → Duration of the communication in seconds (here, 60 seconds).
* `-i` → Interval (in seconds) for reporting statistics.
* `-l` → Datagram size (here, 1400 bytes).
* `-p` → Port number used for communication (which must match the configuration on the Raspberry Pi).

The layout of iPerf2 for Android is similar to the image below.

![iPerf2](https://github.com/user-attachments/assets/9f644faf-10e6-48a3-827b-882a90ab5938)

---

### CSI Data Capture

The CSI data capture is performed using a [script](https://github.com/ljr-ita/csi-sec-course/blob/main/Rasp/capture_csi.sh) available on the Raspberry Pi:

```bash
sudo ./capture_csi.sh 3 20 /home/pi/csi.pcap 36/40 15
```

With the following parameter specifications:

* `sudo ./capture_csi.sh` → Executes the capture script.
* `3` → Delay (in seconds) before capture begins.
* `20` → Capture duration in seconds.
* `/home/pi/csi.pcap` → Path and filename of the output file.
* `36/40` → Channel and bandwidth (must match the configuration set within the [script](https://github.com/ljr-ita/csi-sec-course/blob/main/Rasp/capture_csi.sh)).
* `15` → Transmission power in dBm.

---

### Accessing the Captured Data

To access the output file (`.pcap`) generated by the script, a **Secure File Transfer Protocol (SFTP)** connection can be established as follows:

1. Connect the Raspberry Pi to the network via Ethernet cable or Wi-Fi.
2. Verify the Raspberry Pi IP address using the `ifconfig` command.
3. Create an SFTP session:

   ```bash
   sftp <USER>@<Raspberry_IP>
   ```
4. List the files in the working directory (where the CSI data was captured):

   ```bash
   ls -F | grep -v /
   ```
5. Retrieve the desired file:

   ```bash
   get <file_name.pcap>
   ```

---

### Data Conversion

Once transferred, the `.pcap` file can be processed to extract **amplitude** and **phase** information for each subcarrier by executing the conversion code available in the designated [*converter*](https://github.com/ljr-ita/csi-sec-course/blob/main/Rasp/Conversor_amp_pha_CSIdata_rasp.ipynb).

